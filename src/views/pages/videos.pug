extends ../layout/page

prepend content
  h2 Videos
  p 
  // this is a list of videos
  h3 Purchased
  hr
  .row
    //- users videos
    if (videos)
      for video in videos
        .col-xs-4
          if (video.isPaid)
            video(controls, poster=video.path_image, type="video/mp4", width=250, src=video.path)
            .row
              a.btn.btn-primary(href=video.path, download) Download
          else
            video(controls, poster=video.path_image, type="video/mp4", width=250, src=video.path)
          include ../include/crypto-vod
  .row
    if (message||error)
      .message
        if (message)
          h5 #{message}
        if (error)
          h5 #{error}
  h3 Archive
  hr
  .row
    //- all videos
    if (videos_all)
      for video in videos_all
        .col-xs-4
          video(controls, poster=video.path_image, type="video/mp4", width=250, src=video.path)
          include ../include/crypto-vod

prepend javascript
  script.
    function generateVoDAddress(video) {
      console.log('video: %s', video);
      return Promise.resolve($.ajax({
        type: 'GET',
        url: '/address-vod',
        data: {'_csrf':"#{_csrf}",'video':video},
        success: function(data) {
          location.reload();
        },
        error: function(data) {
          alert("Please login or create an account!");
        },
      })).catch(function (reason) {
        //- console.log(reason);
      });
    }